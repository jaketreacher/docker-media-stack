version: '3'
services:
  vpn:
    image: bubuntux/nordvpn
    container_name: nord
    cap_add:
      - net_admin
    devices:
      - /dev/net/tun
    environment:
      - NETWORK=192.168.1.0/24
      - OPENVPN_OPTS=--pull-filter ignore "ping-restart" --ping-exit 180
    env_file: ./.env
    ports:
      - 7878:7878
      - 8989:8989
      - 8112:8112
      - 9117:9117
      - 3579:3579
    restart: unless-stopped

  sonarr:
    image: linuxserver/sonarr:latest
    container_name: sonarr
    network_mode: service:vpn
    volumes:
      - ${CONFIG_DIR:?}/sonarr:/config
      - ${MEDIA_DIR:?}/series:/tv
      - ${DOWNLOAD_DIR:?}:/downloads
    env_file: ./.env
    restart: unless-stopped

  radarr:
    image: linuxserver/radarr:latest
    container_name: radarr
    network_mode: service:vpn
    volumes:
      - ${CONFIG_DIR:?}/radarr:/config
      - ${MEDIA_DIR:?}/movies:/movies
      - ${DOWNLOAD_DIR:?}:/downloads
    env_file: ./.env
    restart: unless-stopped

  deluge:
    image: linuxserver/deluge:latest
    container_name: deluge
    network_mode: service:vpn
    volumes:
      - ${CONFIG_DIR:?}/deluge:/config
      - ${DOWNLOAD_DIR:?}:/downloads
    env_file: ./.env
    restart: unless-stopped

  jackett:
    image: linuxserver/jackett:latest
    container_name: jackett
    network_mode: service:vpn
    volumes:
      - ${CONFIG_DIR:?}/jackett:/config
    env_file: ./.env
    restart: unless-stopped

  ombi:
    image: linuxserver/ombi
    container_name: ombi
    network_mode: service:vpn
    volumes:
      - ${CONFIG_DIR:?}/ombi:/config
    env_file: ./.env
    restart: unless-stopped

  watchtower:
    image: v2tec/watchtower:latest
    container_name: watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    command: -s "0 0 3 * * *" --cleanup
    env_file: ./.env
    restart: unless-stopped
